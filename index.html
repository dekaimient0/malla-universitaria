<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Malla Interactiva</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      text-align: center;
    }
    .semestre {
      margin-bottom: 2rem;
    }
    .semestre h2 {
      margin-bottom: 0.5rem;
    }
    .ramos {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .ramo {
      padding: 1rem;
      border-radius: 0.5rem;
      background: #eee;
      cursor: pointer;
      transition: all 0.3s;
    }
    .ramo.aprobado {
      background: #90ee90;
      text-decoration: line-through;
    }
    .ramo.bloqueado {
      background: #ddd;
      color: #999;
      cursor: not-allowed;
    }
    button {
      margin-top: 2rem;
      display: block;
      margin-left: auto;
      margin-right: auto;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.5rem;
      background-color: #c62828;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva</h1>
  <div id="malla"></div>
  <button onclick="resetProgreso()">Reiniciar progreso</button>

  <script>
    const malla = [
      {
        nombre: "I Semestre",
        ramos: [
          { id: "sociedad1", nombre: "Sociedad y Profesión I", prerequisitos: [] },
          { id: "fisica1", nombre: "Física I", prerequisitos: [] },
          { id: "anatomia", nombre: "Anatomía", prerequisitos: [] },
          { id: "quimica", nombre: "Química General y Orgánica", prerequisitos: [] },
          { id: "biocel", nombre: "Biología Celular y Molecular", prerequisitos: [] },
          { id: "mate1", nombre: "Matemática I", prerequisitos: [] }
        ]
      },
      {
        nombre: "II Semestre",
        ramos: [
          { id: "sociedad2", nombre: "Sociedad y Profesión II", prerequisitos: ["sociedad1"] },
          { id: "fisica2", nombre: "Física II", prerequisitos: ["fisica1", "mate1"] },
          { id: "fisiologia1", nombre: "Fisiología I", prerequisitos: ["fisica1", "quimica"] },
          { id: "bioquimica", nombre: "Bioquímica", prerequisitos: ["quimica"] },
          { id: "genetica", nombre: "Genética", prerequisitos: [] },
          { id: "histologia", nombre: "Histología y Embriología", prerequisitos: [] },
          { id: "mate2", nombre: "Matemática II", prerequisitos: ["mate1"] }
        ]
      }
      // Puedes seguir agregando más semestres aquí
    ];

    const progreso = JSON.parse(localStorage.getItem("progresoMalla") || "{}");

    function guardarProgreso() {
      localStorage.setItem("progresoMalla", JSON.stringify(progreso));
    }

    function resetProgreso() {
      if (confirm("¿Seguro que quieres reiniciar tu progreso?")) {
        localStorage.removeItem("progresoMalla");
        location.reload();
      }
    }

    function crearMalla() {
      const contenedor = document.getElementById("malla");
      contenedor.innerHTML = "";

      malla.forEach((semestre) => {
        const divSem = document.createElement("div");
        divSem.className = "semestre";

        const h2 = document.createElement("h2");
        h2.textContent = semestre.nombre;

        const divRamos = document.createElement("div");
        divRamos.className = "ramos";

        semestre.ramos.forEach((ramo) => {
          const divRamo = document.createElement("div");
          divRamo.className = "ramo";
          divRamo.textContent = ramo.nombre;

          const aprobados = Object.keys(progreso).filter((id) => progreso[id]);
          const tieneTodosLosPrerequisitos = ramo.prerequisitos.every((id) =>
            aprobados.includes(id)
          );

          if (progreso[ramo.id]) {
            divRamo.classList.add("aprobado");
          } else if (!tieneTodosLosPrerequisitos && ramo.prerequisitos.length > 0) {
            divRamo.classList.add("bloqueado");
          }

          if (tieneTodosLosPrerequisitos || ramo.prerequisitos.length === 0) {
            divRamo.addEventListener("click", () => {
              progreso[ramo.id] = !progreso[ramo.id];
              guardarProgreso();
              crearMalla();
            });
          }

          divRamos.appendChild(divRamo);
        });

        divSem.appendChild(h2);
        divSem.appendChild(divRamos);
        contenedor.appendChild(divSem);
      });
    }

    crearMalla();
  </script>
</body>
</html>
